library(tidytext)
library(tidyverse)

set.seed(1)
N <- 1000
word_scores <- tibble(group= sample(x=c("A","B", "C", "D"), size=N, replace=TRUE),
                      word=stop_words$word[0:N], 
                      score=rexp(N, 1/4))
word_scores %>%
  group_by(group) %>%
  slice_max(score, n = 15) %>%
  ungroup() %>%
  ggplot(aes(score, reorder(word, score), fill = group)) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~group, ncol = 2, scales = "free") +
  labs(x = NULL, y = NULL)

word_scores %>%
  group_by(group) %>%
  slice_max(score, n = 15) %>%
  ungroup() %>%
  filter(group == "B") %>%
  ggplot(aes(score, reorder(word, score))) +
  geom_col(show.legend = FALSE) +
  labs(x = NULL, y = NULL)

df <- structure(list(Model_Name = c("1", "1", "1", "1", "1", "1", "1", 
                                    "1", "1", "1", "1", "2", "2", "2", "2", "2", "2", "2", "2", "2", 
                                    "2", "2", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", 
                                    "4", "4", "4", "4", "4", "4", "4", "4", "4", "4", "4"), Feature = c("EBIT.FinExp", 
                                                                                                        "DailySALES.EBIT", "logTA", "TL.TA", "CF.NCL", "TL.EQ", "CL.FinExp", 
                                                                                                        "CA.CL", "CA.TA", "EQ.Turnover", "SALES.WC", "logTA", "EBIT.FinExp", 
                                                                                                        "TL.TA", "EQ.Turnover", "CL.FinExp", "CA.TA", "TL.EQ", "CF.NCL", 
                                                                                                        "CA.CL", "DailySALES.EBIT", "SALES.WC", "logTA", "TL.TA", "EBIT.FinExp", 
                                                                                                        "TL.EQ", "CA.TA", "CL.FinExp", "EQ.Turnover", "CA.CL", "SALES.WC", 
                                                                                                        "DailySALES.EBIT", "CF.NCL", "logTA", "TL.TA", "TL.EQ", "CA.TA", 
                                                                                                        "CL.FinExp", "EQ.Turnover", "SALES.WC", "EBIT.FinExp", "CA.CL", 
                                                                                                        "DailySALES.EBIT", "CF.NCL"), Gain = c(0.319661022583932, 0.1459294841629, 
                                                                                                                                               0.142850179507091, 0.132765644191462, 0.0810216258897842, 0.0427415667709611, 
                                                                                                                                               0.0398929568321689, 0.038977683436756, 0.0235407288506038, 0.0177791651224692, 
                                                                                                                                               0.0148399426518705, 0.314495967867966, 0.194685182626366, 0.140733861259937, 
                                                                                                                                               0.0882380538977587, 0.0574929508879213, 0.0465452034142143, 0.0409126137922541, 
                                                                                                                                               0.0356003145682383, 0.0300757198164929, 0.029110471062585, 0.0221096608062664, 
                                                                                                                                               0.397020881823162, 0.143886886033381, 0.0915945975581377, 0.0699399814849332, 
                                                                                                                                               0.0633989152531246, 0.0608103962252964, 0.0512060957146738, 0.039355302553383, 
                                                                                                                                               0.0342297915015821, 0.0255241325884949, 0.0230330192638316, 0.38056229652222, 
                                                                                                                                               0.133231017163002, 0.0941844467535513, 0.0788600251129408, 0.0749519130106986, 
                                                                                                                                               0.0521907558198196, 0.0498475034974015, 0.0433895506999798, 0.0428104836292833, 
                                                                                                                                               0.0273526930263904, 0.0226193147647128), Cover = c(0.121943691387452, 
                                                                                                                                                                                                  0.0816186622203503, 0.234722543977359, 0.171634330582589, 0.0892304037319097, 
                                                                                                                                                                                                  0.0315468239516433, 0.0963968265880753, 0.0607290547248047, 0.0452337706760221, 
                                                                                                                                                                                                  0.0279521362780545, 0.0389917558817403, 0.227632942870328, 0.0878012612621709, 
                                                                                                                                                                                                  0.132093360664219, 0.0904386168640914, 0.109620838100331, 0.0915521745157415, 
                                                                                                                                                                                                  0.0239824724837257, 0.0573896745122457, 0.0601712810342116, 0.0639922580136253, 
                                                                                                                                                                                                  0.0553251196793097, 0.231725278554576, 0.103655920813926, 0.0814217672437898, 
                                                                                                                                                                                                  0.0491388474456846, 0.118941515640324, 0.0964283304134241, 0.0947214507718667, 
                                                                                                                                                                                                  0.0741550093313701, 0.0558597882883057, 0.0425784549213668, 0.0513736365753665, 
                                                                                                                                                                                                  0.201160082759667, 0.0826529411502635, 0.0493477928111075, 0.111213779712931, 
                                                                                                                                                                                                  0.110738868440133, 0.102709355008914, 0.0534211062162858, 0.101876672415992, 
                                                                                                                                                                                                  0.067425714362272, 0.0636683097957719, 0.0557853773266621), Frequency = c(0.104681978798587, 
                                                                                                                                                                                                                                                                            0.0940812720848057, 0.152385159010601, 0.125883392226148, 0.0936395759717314, 
                                                                                                                                                                                                                                                                            0.0415194346289753, 0.0954063604240283, 0.0874558303886926, 0.075530035335689, 
                                                                                                                                                                                                                                                                            0.0636042402826855, 0.0658127208480565, 0.141749246014649, 0.0896165445928479, 
                                                                                                                                                                                                                                                                            0.112882378285222, 0.0934941835415769, 0.0947867298578199, 0.100387763894873, 
                                                                                                                                                                                                                                                                            0.042654028436019, 0.0779836277466609, 0.0822921154674709, 0.0861697544161999, 
                                                                                                                                                                                                                                                                            0.0779836277466609, 0.157513835674755, 0.0906768837803321, 0.0936568752660707, 
                                                                                                                                                                                                                                                                            0.0510855683269476, 0.108982545764155, 0.102596849723287, 0.0932311621966794, 
                                                                                                                                                                                                                                                                            0.0872711792252022, 0.0825883354618987, 0.0723712217965091, 0.0600255427841635, 
                                                                                                                                                                                                                                                                            0.121157323688969, 0.0822784810126582, 0.0592224231464738, 0.117088607594937, 
                                                                                                                                                                                                                                                                            0.0981012658227848, 0.099005424954792, 0.0981012658227848, 0.0958408679927667, 
                                                                                                                                                                                                                                                                            0.0840867992766727, 0.0782097649186257, 0.0669077757685353)), row.names = c(NA, 
                                                                                                                                                                                                                                                                                                                                                        -44L), class = c("data.table", "data.frame"))

df %>% 
  ggplot(aes(x = reorder(Feature, Gain), y = Gain)) +
  geom_bar(stat = "identity") +
  coord_flip()

df %>% 
  ggplot(aes(x = reorder(Feature, Gain), y = Gain)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  facet_wrap(~Model_Name)

df %>% 
  ggplot(aes(x = stats::reorder(paste(Feature, Model_Name, sep = "__"), Gain), y = Gain)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  facet_wrap(~Model_Name, scales = "free")